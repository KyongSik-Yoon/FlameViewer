<idea-plugin url="https://github.com/kornilova-l/flamegraph-visualizer">
    <id>com.github.kornilovaL.flamegraphProfiler</id>
    <name>FlameViewer</name>
    <version>0.8.1-SNAPSHOT</version>

    <vendor url="https://github.com/kornilova-l" email="kornilova203@gmail.com"/>

    <description><![CDATA[
Flamegraph Viewer & Instrumentation Java Profiler Fierix<br>
<strong>Upload file to FlameViewer</strong>
<ol>
    <li>Click <strong>Tools | Open FlameViewer...</strong></li>
    <li>Upload a file of a supported profiler:
        <ul>
            <li><i>jfr</i> files generated by Flight Recorder</li>
            <li>Yourkit <i>csv</i> files. To generate csv file from a snapshot run following script: <code>java -jar -Dexport.call.tree.cpu -Dexport.csv /lib/yjp.jar -export ~/Snapshots/.snapshot</code></li>
            <li>Files in flamegraph format</li>
            <li><i>fierix</i> files generated by bundled Fierix profiler (IntelliJ IDEA only)</li>
        </ul>
    </li>
</ol>

<strong>Java performance recording quick start</strong><br>
Use Flight Recorder to profile your program and then open flamegraph:
<ol>
    <li>Run JVM with following VM options: <code>-XX:+UnlockCommercialFeatures -XX:+FlightRecorder -XX:StartFlightRecording=duration=30s,filename=my_recording.jfr -XX:FlightRecorderOptions=stackdepth=256</code></li>
    <li>Open FlameViewer <strong>Tools | Open FlameViewer...</strong></li>
    <li>Upload <i>my_recording.jfr</i></li>
</ol>
<strong>Fierix (only IntelliJ IDEA)</strong><br>
Fierix is a bundled instrumentation Java profiler that allows to save parameters of method calls, specify what methods will be instrumented and view a call tree.
<ol>
    <li>To specify methods that will be recorded open <strong>Tools | Fierix | Edit Configuration...</strong></li>
    <li>To run program with profiler select the desired run configuration and choose <strong>Run <name> with Fierix</strong></li>
    <li>Also you can configure profiler to save value of method's parameters or it's return value. This should be done if you want to see how parameters influence method's performance. To enable this option check 'Save' checkbox beside type of parameter(s) when editing pattern in configuration.</li>
    <li>To open results click <strong>Tools | Fierix | Open Results...</strong></li>
</ol>

Detailed description at <a href="https://github.com/kornilova-l/flamegraph-visualizer">github.com/kornilova-l/flamegraph-visualizer</a>
    ]]></description>

    <change-notes><![CDATA[
    <ul>
      <li>Optimized visualization of big trees.</li>
      <li>Bug fixes and minor improvements.</li>
    </ul>
    ]]>
    </change-notes>

    <idea-version since-build="162"/>

    <!-- Enable in all IDEs -->
    <depends>com.intellij.modules.lang</depends>

    <depends optional="true" config-file="Fierix.xml">com.intellij.modules.java</depends>

    <extensionPoints>
        <extensionPoint name="profilerToFlamegraphConverter"
                        interface="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_file.ProfilerToFlamegraphConverter"/>
        <extensionPoint name="profilerToCompressedFlamegraphConverter"
                        interface="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_file.ProfilerToCompressedFlamegraphConverter"/>
        <extensionPoint name="fileToCallTreeConverter"
                        interface="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_call_tree.FileToCallTreeConverter"/>
        <extensionPoint name="fileToCallTracesConverter"
                        interface="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_call_traces.FileToCallTracesConverter"/>
    </extensionPoints>

    <extensions defaultExtensionNs="com.intellij">
        <httpRequestHandler
                implementation="com.github.kornilova_l.flamegraph.plugin.server.ProfilerHttpRequestHandler"/>
    </extensions>

    <extensions defaultExtensionNs="com.github.kornilovaL.flamegraphProfiler">
        <profilerToFlamegraphConverter
                implementation="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_file.jmc.JMCConverter"/>
        <profilerToCompressedFlamegraphConverter
                implementation="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_file.yourkit_csv.YourkitCsvToCFlamegraphConverter"/>
        <fileToCallTracesConverter
                implementation="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_call_traces.yourkit_csv.YourkitCsvToCallTracesConverter"/>
        <fileToCallTracesConverter
                implementation="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_call_traces.flamegraph.FlamegraphToCallTracesConverter"/>
        <fileToCallTracesConverter
                implementation="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_call_traces.cflamegraph.CompressedFlamegraphToCallTracesConverter"/>
        <fileToCallTreeConverter
                implementation="com.github.kornilova_l.flamegraph.plugin.server.converters.file_to_call_tree.fierix.FierixToCallTreeConverter"/>
    </extensions>

    <actions>
        <action class="com.github.kornilova_l.flamegraph.plugin.server.ShowUploadFilePageAction"
                id="FlameViewer.UploadFile" text="Open FlameViewer..." icon="ProfilerIcons.flameIcon">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
    </actions>

</idea-plugin>
